site_type: logistics_center            # Standort des Ladepunkts

time_resolution_min: 15               # Zeitschritt, in der die Simulation abgebildet wird
simulation_horizon_days: 8            # gewünschter Analysehorizont in Tagen

start_datetime: "2025-01-01 00:00"    # Zeitpunkt, ab dem der Lastgang anfangen soll
holidays:
  country: "DE"
  subdivision: "BY"                   # Bundesland als Code: BW, BY, BE, BB, HB, HH, HE, MV, NI, NW, RP, SL, SN, ST, SH, TH
  dates: []                           # zusätzliche bekannte betriebsfreie Tage manuell eingeben, getrennt durch neue Zeile (- "2026-01-01")


site:
  number_chargers: 20                                          # Anzahl der Ladepunkte am Standort
  rated_power_kw: 12                                         # Verfügbare Leistung pro Ladepunkt
  grid_limit_p_avb_kw: 200                                    # Maximale Anschlussleistung durch Netzbetreiber vorgegeben
  expected_sessions_per_charger_per_day: [1.0, 4.0]            # erwartete Ladevorgänge pro LP und Tag
  charger_efficiency: 0.95                                    # Verhältnis Fahrzeugaufnahme zu abgegebener LP-Leistung
  allow_cross_day_charging: true                              # Ermöglicht Ladungen über Mitternacht hinaus

  # =============================================================================
  # Lademanagementstrategie des Standorts
  # =============================================================================
  # Daten für generation / market: https://www.smard.de/home/downloadcenter/download-marktdaten/

  charging_strategy: "generation"                              # Lademanagementstrategie: "immediate" (default), "market", "generation"

  # CSV-Datei: PV-Erzeugung (generation)
  generation_strategy_csv: "../data/strategies/generation/latest.csv"   # Pfad bei vorhandenen Daten zur Stromgeneration
  generation_strategy_value_col: 7                                      # Spalte mit den Werten (1-basiert)
  generation_strategy_unit: "MWh"                                       # Einheit ("MWh", "kWh", "kW", "€/MWh")
  pv_profile_reference_kwp: 108500000                                   # Referenz installierte Leistung (z. B. DE gesamt)
  pv_system_size_kwp: 5000                                               # Größe der untersuchten Anlage in kWp

  # CSV-Datei: Marktpreise (market)
  market_strategy_csv: "../data/strategies/market/latest.csv"           # Pfad bei vorhandenen Daten zu Strompreisen
  market_strategy_value_col: 3                                          # Spalte mit den Werten (1-basiert)
  market_strategy_unit: "€/MWh"                                         # Einheit (z. B. "€/MWh", "€/kWh")


  # =============================================================================
  # Grundlast des Standorts - Gebäudeprofil
  # =============================================================================
  # Die Grundlast beschreibt den zeitlich aufgelösten Stromverbrauch des Gebäudes im 15-Minuten-Raster
  #
  # Wird eine CSV angegeben, wird deren Profil als zeitlicher Verlauf ("Shape") verwendet und auf den
  # angegebenen Standort skaliert:
  # - base_load_unit = "kWh":
  #     CSV-Werte sind Energie pro Zeitschritt (z. B. normierte Profile).
  #     Die Werte werden auf base_load_annual skaliert und anschließend in kW umgerechnet.
  # - base_load_unit = "kW":
  #     CSV-Werte sind mittlere Leistung je Zeitschritt.
  #     Das Profil wird so skaliert, dass seine mittlere Leistung base_load_annual entspricht.
  #
  # Ist keine CSV angegeben, wird eine konstante Grundlast verwendet.

  # Option A: konstante Grundlast (kW)
  base_load_kw: 0                                             # konstante Grundlast (kW)

  # Option B: Grundlast aus CSV-Datei (hat Vorrang gegenüber Option A)
  base_load_csv: "../data/building_loads/logistics_center_tub_2018.csv"       # Pfad zu den Gebäudeprofilen
  base_load_value_col: 2                                                    # Spalte mit dem Profilwert (1-basiert)
  base_load_unit: "kWh"                                                     # "kWh" oder "kW"
  base_load_annual: 200000                                                  # jährlicher Verbrauch (kWh) oder mittlere Leistung (kW), passend zur Einheit


# =============================================================================
# Fuhrparkbeschreibung – Ladekurven + Kapazitäten kommen aus CSV
# =============================================================================

vehicles:
  soc_target: 1.0                                              # Gewünschter Ladezustand am Ende des Ladeprozesses
  vehicle_curve_csv: "../data/Ladekurven_Master.csv"            # Batteriekapazität und Ladekurve nach SOC
  fleet_mix:                                                    # Gewichtung der Fahrzeugtypen - PKW & Transporter
    PKW: 0.01
    Transporter: 0.99


# =============================================================================
# Ankunftszeiten, Standzeit und SoC bei Ankunft
# =============================================================================

# Ankunftszeiten an den Ladepunkten
arrival_time_distribution:
  type: mixture
  time_unit: minutes

  # Skalierung der Ladevorgänge je nach Tagtyp
  weekday_weight:
    working_day: [0.8, 1.5]               # hoher Betrieb an Arbeitstagen (Schichtbetrieb)
    saturday: [0.4, 0.8]                  # reduzierter Betrieb am Samstag
    sunday_holiday: [0.2, 0.4]            # geringer Betrieb an Sonn- und Feiertagen (z. B. Not-/Teilbetrieb)

  components_per_weekday:
    # Logistics Center: zeitfensterbasierte Ankünfte (Slots/Touren) – Peaks um 07:00, 13:00 und 23:00
    # Die Bennenung 'name' hat keine Funktion für den Code und kann beliebig angepasst werden
    working_day:
      - name: peak_1                      # Schichtbeginn morgens
        distribution: normal
        mu: 7.00                          # Mittelwert in Stunden (um shift_minutes zentriert)
        sigma: 0.40                       # Streuung in Stunden (0.40h ≈ 24 min)
        shift_minutes: 0
        weight: 0.21                      # Gewichtung innerhalb working_day

      - name: peak_2                      # Schichtwechsel / Mittag (breiter, z. B. Pausen/wechselnde Startzeiten)
        distribution: normal
        mu: 13.00
        sigma: 2.80                       # Streuung in Stunden (2.8h ≈ 168 min)
        shift_minutes: 0
        weight: 0.575

      - name: peak_3                      # Schichtbeginn abends/nachts
        distribution: normal
        mu: 23.00
        sigma: 2.00                       # Streuung in Stunden (2h = 120 min)
        shift_minutes: 0
        weight: 0.22

    # Samstag: typischerweise weniger Schichten / verkürzte Produktion
    saturday:
      - name: peak_4
        distribution: normal
        mu: 13.00
        sigma: 3.0
        shift_minutes: 0
        weight: 0.7

      - name: peak_5
        distribution: normal
        mu: 01.00
        sigma: 2.00
        shift_minutes: 0
        weight: 0.3

    # Sonntag/Feiertag: Notbetrieb / Wartung / Security / einzelne Lieferfenster
    sunday_holiday:
      - name: peak_6
        distribution: normal
        mu: 11.00
        sigma: 3.50
        shift_minutes: 0
        weight: 1.0


# Parkdauer in Minuten ab Ankunft; Verteilung ist eine Mischung aus Kurz- und Langzeitparkern
# Logistics Center: Langparker über Nacht, Kurzparker bei Schichtwechsel, Beladen und Entladen
parking_duration_distribution:
  type: mixture
  time_unit: minutes
  max_duration_minutes: 600                 # Obergrenze maximale Ladedauer
  min_duration_minutes: 20                  # Untergrenze minimale Ladedauer

  components:
  # Die Bennenung 'name' hat keine Funktion für den Code und kann beliebig angepasst werden
    - name: long_stay                       # Nachtladungen (lange Standzeit)
      distribution: normal
      weight: 0.6
      mu: [420, 600]                        # typische Parkdauer 7–10 Stunden
      sigma: [60, 120]                      # Streuung 1–2 Stunden

    - name: short_stay                      # kürzere Parkzeit bei Schichtwechsel
      distribution: normal
      weight: 0.4
      mu: [60, 180]                         # typische Parkdauer 1–3 Stunden
      sigma: [30, 60]


# Batteriezustand bei Ankunft; Verteilung ist eine Mischung aus gezieltem Laden und opportunistischem Laden
# Logistics Center: stärker bedarfsgetrieben (niedriger bis mittlerer SoC), opportunistisches Laden seltener
soc_at_arrival_distribution:
  type: mixture
  value_unit: fraction                      # 0.0 bis 1.0
  max_soc: 0.80                             # maximales SoC bei Ankunft

  components:
  # Die Bennenung 'name' hat keine Funktion für den Code und kann beliebig angepasst werden
    - name: low_battery_charging            # LKW
      distribution: normal
      weight: 0.6
      mu: [0.1, 0.5]
      sigma: [0.05, 0.15]

    - name: opportunistic_charging          # Transporter / Last-Mile
      distribution: normal
      weight: 0.15
      mu: [0.6, 0.8]
      sigma: [0.07, 0.12]
